|                          |                       |              |                  |
| ------------------------ | --------------------- | ------------ | ---------------- |
| **华为云基线安全检查表** |                       |              |                  |
| **文件编码**             |                       | **版本**     | V1.0.0           |
| **文件层级**             | 一阶   二阶  三阶四阶 | **文件类别** | 体系文件         |
| 技术文件                 |                       |              |                  |
| **编制部门**             | 运维部                | **机密等级** | 内部公开外部公开 |
| 企业机密企业秘密         |                       |              |                  |
| **编制人**               |                       | **文件类型** | ■通用 □项目      |
| **审核**                 |                       | **编制日期** | 2023.7.10        |
| **审批**                 |                       | **生效日期** | 2023.7.21        |
| **文件发布盖章**         |                       |              |                  |

# **目的**

为了确保公司华为云基础环境的安全性和合规性，我们特别制定了以下详细的检查表来进行全面的安全评估。本检查表旨在识别潜在的安全风险、漏洞以及不符合最佳实践的做法，以确保基础服务能够提供可靠且安全的服务。

# **检查工具**

通过人工登录到华为云控制台依照检查项进行挨个配置检查。

# **检查项**





| **分类**                                                     | **检查项目**                                                 | **检查内容**                                                 |
| ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| **分类**                                                     | **检查项目**                                                 | **检查内容**                                                 |
| 身份与访问管理                                               | IAM用户启用检查                                              | 启用统一身份认证（Identity and Access Management，IAM）服务后，系统默认用户组admin中的IAM用户，可以使用华为云所有服务。 |
| 检查所有IAM用户列表，是否已启用至少两个IAM用户，以及IAM用户所属的用户组是否都为admin用户组。 |                                                              |                                                              |
| IAM用户开启登录保护检查                                      | 在IAM的安全设置中启用登录保护后，登录时还需要通过虚拟MFA或短信或邮件验证，再次确认登录者身份，进一步提高账号安全性，有效避免钓鱼式攻击或者用户密码意外泄漏，保护您安全使用云产品。 |                                                              |
| 检查在IAM的安全设置中是否开启登录保护。                      |                                                              |                                                              |
| IAM用户开启操作保护检查                                      | 在IAM的安全设置中开启操作保护后，主账户及子用户在控制台进行敏感操作（如：删除弹性云服务器、解绑弹性IP等）时，将通过虚拟MFA、手机短信或邮件再次确认操作者身份，进一步提高账号安全性，有效保护您安全使用云产品。 |                                                              |
| 检查IAM用户是否开启操作保护。                                |                                                              |                                                              |
| IAM用户密码配置检查                                          | IAM用户的密码策略建议设置强密码策略。建议满足以下要求：包含以下字符中的3种：大写字母、小写字母、数字和特殊字符；密码最小长度为8；新密码不能与最近的历史密码相同（重复次数设置为5）,密码有效期180天。 |                                                              |
| 检查IAM用户的密码策略是否符合要求。                          |                                                              |                                                              |
| IAM登录验证策略（账号锁定策略）检查                          | IAM允许用户设置账号锁定策略，即如果在限定时间长度内达到登录失败次数后，用户会被锁定一段时间，锁定时间结束后，才能重新登录。 |                                                              |
| 建议设置为在15分钟内登录失败5次，用户被锁定。                |                                                              |                                                              |
| 检查账号锁定策略是否设置为在15分钟内登录失败5次，用户被锁定。 |                                                              |                                                              |
| 会话超时策略检查                                             | IAM允许用户设置会话到期时间。如果用户超过设置的时长未操作界面，会话将会失效，需要重新登录。 |                                                              |
| 检查会话时限是否设置为15分钟。                               |                                                              |                                                              |
| 账号停用策略检查                                             | IAM用户可以通过使用用户名和密码登录华为云控制台。如果用户在90天或更长时间内未登录控制台，建议禁用该用户的控制台访问权限。 |                                                              |
| 检查账号停用策略是否启用，且有效期设置为90天。               |                                                              |                                                              |
| IAM用户密码强度检查                                          | IAM用户的登录密码建议设置为安全程度强的密码。                |                                                              |
| IAM用户设置的登录密码分为弱、中、强三个级别。安全性高的密码可以使账号更安全，建议您定期更换密码以保护账号安全。 |                                                              |                                                              |
| 检查IAM用户的密码强度是否为最高级别。                        |                                                              |                                                              |
| CBH实例登录开启多因子认证检查                                | 通过Web浏览器或SSH客户端登录CBH实例时应开启用户的多因子认证，进一步提高堡垒机账号安全性。多因子认证方式有：手机短信、手机令牌、USBKey、动态令牌。 |                                                              |
| 检查CBH实例是否已开启多因子认证。                            |                                                              |                                                              |
| 检测风险项                                                   | ELB健康状态检查                                              | 弹性负载均衡（Elastic Load Balance，ELB）定期向后端服务器发送请求健康检查，通过健康检查来判断后端服务器是否可用。 |
| 如果判断出后端服务器健康检查异常，ELB会将异常后端服务器的流量分发到正常后端服务器。 |                                                              |                                                              |
| 当异常后端服务器恢复正常运行后，ELB会自动恢复其承载业务流量能力。 |                                                              |                                                              |
| 检查所有ELB实例是否开启健康检查功能，以及检查后端服务器状态是否正常。 |                                                              |                                                              |
| CTS启用检查                                                  | 云审计服务（Cloud Trace Service，CTS）可以将当前账户下所有的操作记录在追踪器中，通过查询和审计操作记录，实现安全分析、资源变更、合规审计、问题定位等。 |                                                              |
| 检查是否已经开通CTS，以及检查是否有一个追踪器的状态为正常。  |                                                              |                                                              |
| OBS桶健康状态检查                                            | 对象存储服务（Object Storage Service，OBS）的桶使用状态监控，监控所有桶的存储用量，流量趋势，请求趋势，分析桶的状态是否正常。 |                                                              |
| 检查所有OBS桶，状态是否正常。                                |                                                              |                                                              |
| 云监控服务启用检查                                           | 针对弹性云服务器、带宽等资源的监。全面了解云上的资源使用情况、业务的运行状况，并及时收到异常告警做出反应，保证业务顺畅运行。 |                                                              |
| 检查是否已启用云监控服务。                                   |                                                              |                                                              |
| 云监控服务中的主机监控检查                                   | 主机监控针对主机提供多层次指标监控，包括基础监控、操作系统监控。 |                                                              |
| 检查主机监控中的弹性云服务器是否监控正常。                   |                                                              |                                                              |
| 云监控服务中站点监控检查                                     | 站点监控用于模拟真实用户对远端服务器的访问，从而探测远端服务器的可用性、连通性等问题。 |                                                              |
| 检查是否配置站点监控。                                       |                                                              |                                                              |
| 基础设施防护                                                 | 安全组入方向规则控制检查                                     | 安全组入方向规则应满足最小化访问控制原则。                   |
| 一般，在非业务需要的情况下，以下情况视为未按最小化访问控制（风险由高到低）：源地址为0.0.0.0/0；公网地址的掩码小于32；内网地址的掩码小于24。 |                                                              |                                                              |
| 高危端口、远程管理端口暴露检查                               | 安全组是一个逻辑上的分组，为具有相同安全保护需求并相互信任的云服务器提供访问策略。安全组创建后，可以在安全组中设置出方向、入方向规则，这些规则会对安全组内部的云服务器出入方向网络流量进行访问控制，当云服务器加入该安全组后，即受到这些访问规则的保护。 |                                                              |
| 安全组入方向规则中不应对外开放或未最小化开放高危端口、远程管理端口。 |                                                              |                                                              |
| 高危端口如下：20，21，135，137，138，139，445，389，593，1025 |                                                              |                                                              |
| 未最小化开放指的是：源地址为0.0.0.0/0；公网地址的掩码小于32；内网地址的掩码小于24 |                                                              |                                                              |
| 检查安全组入方向规则中是否存在对外开放或未最小化开放高危端口、远程管理端口。 |                                                              |                                                              |
| 绑定EIP的ECS配置密钥对登录检查                               | 当存在ECS对外暴露EIP的情况下，为安全起见，弹性云服务器登录时应使用密钥方式进行身份验证。 |                                                              |
| 日志指标过滤和告警事件（VPC更改）检查                        | 日志审计模块是信息安全审计功能的核心必备组件，是企事业单位信息系统安全风险管控的重要组成部分。云审计服务（Cloud Trace Service，以下简称CTS），是华为云安全解决方案中专业的日志审计服务，提供对各种云资源操作记录的收集、存储和查询功能，可用于支撑安全分析、合规审计、资源跟踪和问题定位等常见应用场景。 |                                                              |
| 检查CTS中是否存在因VPC更改而产生的日志和告警事件。           |                                                              |                                                              |
| 日志指标过滤和告警事件（网络网关更改）检查                   | 日志审计模块是信息安全审计功能的核心必备组件，是企事业单位信息系统安全风险管控的重要组成部分。云审计服务（Cloud Trace Service，以下简称CTS），是华为云安全解决方案中专业的日志审计服务，提供对各种云资源操作记录的收集、存储和查询功能，可用于支撑安全分析、合规审计、资源跟踪和问题定位等常见应用场景。 |                                                              |
| 检查CTS中是否存在因网络网关更改而产生的日志和告警事件。      |                                                              |                                                              |
| 日志指标过滤和告警事件（安全组更改）检查                     | 日志审计模块是信息安全审计功能的核心必备组件，是企事业单位信息系统安全风险管控的重要组成部分。云审计服务（Cloud Trace Service，以下简称CTS），是华为云安全解决方案中专业的日志审计服务，提供对各种云资源操作记录的收集、存储和查询功能，可用于支撑安全分析、合规审计、资源跟踪和问题定位等常见应用场景。 |                                                              |
| 检查CTS中是否存在因安全组更改而产生的日志和告警事件。        |                                                              |                                                              |
| ELB实例（共享型）启用访问控制检查                            | 共享型负载均衡器用户可以通过添加白名单和黑名单的方式控制访问负载均衡监听器的IP。通过白名单能够设置允许特定IP访问，而其它IP不许访问。通过黑名单能够设置允许特定的IP不能访问，而其它IP允许访问。 |                                                              |
| 检查弹性负载均衡（Elastic Load Balance，ELB）实例，是否开启访问控制策略。 |                                                              |                                                              |
| VPC规划检查                                                  | 如果在当前区域下有多套业务部署，且希望不同业务之间进行网络隔离时，则可为每个业务在当前区域建立相应的VPC。 |                                                              |
| 两个VPC之间可以采用对等连接进行互连。                        |                                                              |                                                              |
| VPC具有区域属性，默认情况下，不同区域的VPC之间内网不互通，同区域的不同VPC内网不互通，同一个VPC下的不同可用区之间内网互通。 |                                                              |                                                              |
| 检查VPC规范是否合理。                                        |                                                              |                                                              |
| WAF启用（云模式/独享模式/ELB模式）检查                       | 启用Web应用防火墙（Web Application Firewall， WAF）服务后，网站所有的公网流量都会先经过Web应用防火墙，恶意攻击流量在Web应用防火墙上被检测过滤，而正常流量返回给源站IP，从而确保源站IP安全、稳定、可用。 |                                                              |
| 检查是否已启用WAF。                                          |                                                              |                                                              |
| WAF防护策略配置（地理位置访问控制）检查                      | WAF的防护策略应配置地理位置访问控制，可针对指定国家、地区的来源IP自定义访问控制。配置后，可以进一步减小业务网站的攻击面（检测版和专业版暂不支持该功能）。 |                                                              |
| Web基础防护配置检查                                          | Web基础防护支持“拦截”（发现攻击行为后立即阻断并记录）和“仅记录”（发现攻击行为后只记录不阻断攻击）模式，检测版仅支持“仅记录”模式。 |                                                              |
| WAF中所有待防护的域名应开启Web基础防护并设置为拦截模式，开启后，默认防范SQL注入、XSS跨站脚本、远程溢出攻击、文件包含、Bash漏洞攻击、远程命令执行、目录遍历、敏感文件访问、命令/代码注入等常规的Web攻击。 |                                                              |                                                              |
| 检查是否已开启Web基础防护并设置为拦截模式。                  |                                                              |                                                              |
| Anti-DDoS流量清洗启用检查                                    | DDoS原生基础防护（Anti-DDoS流量清洗）服务为华为云内公网IP资源，提供网络层和应用层的DDoS攻击防护，并提供攻击拦截实时告警，有效提升用户带宽利用率，保障业务稳定可靠。 |                                                              |
| 检查是否已启用Anti-DDoS流量清洗服务。                        |                                                              |                                                              |
| 云堡垒机启用检查                                             | 云堡垒机（Cloud Bastion Host，CBH）是华为云的一款4A统一安全管控平台，为企业提供集中的账号、授权、认证和审计管理服务。启用后，可实现对服务器、云主机、数据库、应用系统等云上资源的集中管理和运维审计，不仅能保障系统运行安全，且满足相关合规性规范。 |                                                              |
| 检查是否已启用云堡垒机服务。                                 |                                                              |                                                              |
| 主机安全防护启用检查                                         | 企业主机安全服务（Host Security Service，HSS）是提升主机整体安全性的服务。可以全面识别并管理主机中的信息资产，实时监测主机中的风险并阻止非法入侵行为，帮助企业构建服务器安全体系，降低当前服务器面临的主要安全风险。 |                                                              |
| 检查主机是否开启主机安全防护。                               |                                                              |                                                              |
| 主机紧急修复漏洞检查                                         | 企业主机安全服务（Host Security Service，HSS）提供漏洞管理功能，检测Linux软件漏洞、Windows系统漏洞和Web-CMS漏洞。 |                                                              |
| 检查HSS中是否存在紧急修复漏洞。                              |                                                              |                                                              |
| 数据防护风险                                                 | ELB证书有效性检查                                            | 弹性负载均衡（Elastic Load Balance，ELB）支持两种类型的证书，服务器证书和CA证书。配置HTTPS监听器时，需要为监听器绑定服务器证书，如果开启双向认证功能，还需要绑定CA证书。 |
| 检查所有ELB中的证书是否有效可用。如果SSL证书过期且未及时更新，用户访问网站时会显示“网站的安全证书已过期”的告警信息。 |                                                              |                                                              |
| CDN证书有效性检查                                            | 通过配置加速域名的HTTPS证书，并将其部署在全网CDN节点，实现HTTPS安全加速。 |                                                              |
| 检查CDN中证书是否均在有效期内，如果SSL证书过期且未及时更新，用户访问网站时会显示“网站的安全证书已过期”的告警信息。 |                                                              |                                                              |
| RDS数据库绑定EIP时的安全设置检查                             | 当云数据库RDS（Relational Database Service，简称RDS）配置公网连接时，业务数据会在公网上进行传输，数据容易泄露，因此，需要最小化控制访问源以及开启SSL通道、更改默认数据库端口。 |                                                              |
| 检查当RDS数据库配置公网连接时，是否限制访问源以及开启SSL、更改默认端口。 |                                                              |                                                              |
| RDS数据库实例安全组规则检查                                  | 检查关系型数据库（Relational Database Service，RDS）实例所关联的安全组规则是否存在不安全规则，即检查安全组规则的允许范围是否超过使用范围。当源地址为0.0.0.0/0或空时，代表未设置IP访问的限制，数据库将会有高安全风险。不安全规则示例：方向为入方向，协议为任一类别协议，源地址为0.0.0.0/0（所有地址），端口为1~65535或者数据库业务端口，如3306。 |                                                              |
| OBS桶的ACL权限检查                                           | OBS桶ACL是基于账号或用户组的桶级访问控制，桶的拥有者可以通过桶ACL授予指定账号或用户组特定的访问权限。 |                                                              |
| 匿名用户指未注册华为云的普通访客。如果OBS桶的ACL赋予了匿名用户桶的访问权限或ACL访问权限，表示所有人无需经过任何身份验证即可访问OBS桶。 |                                                              |                                                              |
| 检查所有OBS桶，是否给匿名用户赋予桶访问权限或者ACL访问权限。 |                                                              |                                                              |
| 事件响应风险                                                 | 云硬盘备份开启检查                                           | 云备份（Cloud Backup and Recovery）可以为云硬盘（Elastic Volume Service，EVS）提供简单易用的备份服务，当发生病毒入侵、人为误删除、软硬件故障等事件时，可将数据恢复到任意备份点。 |
| 检查所有是否开启云硬盘备份。                                 |                                                              |                                                              |
| ECS/BMS实例的云服务器备份检查                                | 云备份（Cloud Backup and Recovery, CBR）为云内的弹性云服务器（Elastic Cloud Server, ECS）、云耀云服务器（Hyper Elastic Cloud Server，HECS）、裸金属服务器（Bare Metal Server, BMS）（下文统称为服务器）提供简单易用的备份服务，当发生病毒入侵、人为误删除、软硬件故障等事件时，可将数据恢复到任意备份点。 |                                                              |
| 检查ECS/BMS实例是否已开启云服务器备份。                      |                                                              |                                                              |
| WAF防护事件告警通知开启检查                                  | 通过对攻击日志进行通知设置，WAF可将仅记录和拦截的攻击日志通过用户设置的接收通知方式（例如邮件或短信）发送给用户，以便在发生攻击时运维人员进行及时响应，告警频率、事件类型可以根据业务场景进行调整。 |                                                              |
| 检查WAF防护事件是否已开启告警通知。                          |                                                              |                                                              |
| 安全套件覆盖风险                                             | 主机防护状态检查                                             | 企业主机安全服务（Host Security Service，HSS）是提升主机整体安全性的服务，通过主机管理、风险预防、入侵检测、高级防御、安全运营、网页防篡改功能，全面识别并管理主机中的信息资产，实时监测主机中的风险并阻止非法入侵行为，帮助企业构建服务器安全体系，降低当前服务器面临的主要安全风险。 |
| 检查主机是否已开启防护。                                     |                                                              |                                                              |
| 主机安全检测状态检查                                         | 企业主机安全服务（Host Security Service，HSS）将实时检测主机中的风险和异常操作，在每日凌晨将对主机执行全面扫描。执行配置检测后，您可以根据检测结果中的相关信息，修复主机中含有风险的配置项或忽略可信任的配置项。 |                                                              |
| 检查主机的检测结果是否存在异常。                             |                                                              |                                                              |
| WAF（云模式）基础防护配置检查                                | Web基础防护开启后，默认防范SQL注入、XSS跨站脚本、远程溢出攻击、文件包含、Bash漏洞攻击、远程命令执行、目录遍历、敏感文件访问、命令/代码注入等常规的Web攻击。 |                                                              |
| 检查WAF在云模式下是否已开启Web基础防护。                     |                                                              |                                                              |
| WAF（云模式）防护策略配置检查                                | Web基础防护支持“拦截”（发现攻击行为后立即阻断并记录）和“仅记录”（发现攻击行为后只记录不阻断攻击）模式，检测版仅支持“仅记录”模式。 |                                                              |
| WAF中所有待防护的域名应开启Web基础防护并设置为拦截模式，开启后，默认防范SQL注入、XSS跨站脚本、远程溢出攻击、文件包含、Bash漏洞攻击、远程命令执行、目录遍历、敏感文件访问、命令/代码注入等常规的Web攻击。 |                                                              |                                                              |
| 检查WAF在云模式下是否已开启Web基础防护并设置为拦截模式。     |                                                              |                                                              |
|                                                              | 主机弱密码检查                                               | HSS提供基线检查功能，主动检测主机中口令复杂度策略，给出修改建议，帮助用户提升口令安全性检测账口令是否属于常用的弱口令，针对弱口令提示用户修改，防止账户口令被轻易猜解。 |
| 检查主机是否存在弱口令。                                     |                                                              |                                                              |
| 主机加固风险项                                               | 主机高危端口暴露检查                                         | HSS提供资产管理功能，主动检测主机中的开放端口，及时发现主机中含有风险的各项资产。 |
| 如果检测到开放了危险端口或者开放了不必要的端口，需要排查这些端口是否是正常业务使用，如果不是正常业务端口，建议关闭端口。对于危险端口建议进一步检查程序文件，如果存在风险建议删除或者隔离源文件。 |                                                              |                                                              |
| 检查所有主机是否在对外开放或未最小化开放的高危端口。         |                                                              |                                                              |
| CCE集群Kubernetes版本检查                                    | 云容器引擎（Cloud Container Engine，简称CCE）提供高度可扩展的、高性能的企业级Kubernetes集群，支持运行Docker容器。借助云容器引擎，您可以在华为云上轻松部署、管理和扩展容器化应用程序。 |                                                              |
| 当CCE集群Kubernetes版本低于1.15，有安全漏洞风险，建议您进行升级。 |                                                              |                                                              |
| 检查CCE集群Kubernetes版本是否在1.15以下。                    |                                                              |                                                              |